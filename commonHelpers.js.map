{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from \"axios\";\n\n\nexport async function getPictures(picture, limit, page) {\n    try {\n        const url = `https://pixabay.com/api/?key=42459429-d6d7a0fe637ea3675bc35ddeb&q=${picture}&page=${page}&per_page=${limit}`;\n        const response = await axios.get(url)\n        return response.data;\n    } catch (error){\n        console.log(error)\n    }\n    \n    \n\n    \n}\n","\nexport function createMarkup({ webformatURL, largeImageURL, likes, views, comments, downloads, tags }) {\n  \n        return `<li>\n        <div>\n        <a href=\"${largeImageURL}\">\n        <img src=\"${webformatURL}\" alt=\"${tags}\">\n        </a>\n        </div>\n        <div class=\"text-content\">\n        <p><span class=\"text-span\">Likes</span><br>${likes}</p>\n        <p><span class=\"text-span\">Views</span><br>${views}</p>\n        <p><span class=\"text-span\">Comments</span><br>${comments}</p>\n        <p><span class=\"text-span\">Downloads</span><br>${downloads}</p>\n        </div>\n        </li>`;\n}\n\n\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nimport { getPictures } from './js/pixabay-api';\nimport { createMarkup } from './js/render-functions';\n\nconst form = document.querySelector('.searchForm');\nconst loader = document.querySelector('.css-loader');\nconst gallery = document.querySelector('.galleryDetails');\nconst loadBtn = document.querySelector('.load-more-btn');\n\nconst lightbox = new SimpleLightbox('div a', {\n                captionsData: 'alt',\n                captionDelay: 250,\n                preloading: true,\n            });\n\nlet page = 1;\nconst limit = 15;\nlet current_query;\nlet current_page;\n\nform.addEventListener('submit', onFormHandler);\n\nfunction onFormHandler(event) {\n    event.preventDefault();\n    loader.classList.add('loader');\n\n    gallery.innerHTML = null;\n    const query = event.target.elements.name.value.trim();\n\n    if (!query) {\n        loader.classList.remove('loader');\n        return iziToast.warning({ message: \"Must be filled\" });\n    }\n\n    getPictures(query, limit, page)\n        .then(data => {\n            if (!data.hits || data.hits.length === 0) {\n                return iziToast.error({ message: \"Sorry, there are no images matching your search query. Please try again!\" });\n            }\n           \n            const images = data.hits;\n            const markup = images.map(image => createMarkup(image)).join('');\n\n            gallery.innerHTML = markup;\n            current_query = query;\n            current_page = page;\n            loadBtn.classList.remove('visually-hidden')\n            \n             if (data.totalHits < limit) {\n                iziToast.warning({ message: `Only ${data.totalHits} pictures with your request were found`});\n                loadBtn.classList.add('visually-hidden')\n             }\n            \n            lightbox.refresh();\n            loader.classList.remove('loader');\n        })\n        .catch(() => {\n            iziToast.error({ message: \"Error occurred while fetching images. Please try again later!\" });\n        }).finally(() => {\n            loader.classList.remove('loader');\n        });\n    \n    loadBtn.addEventListener('click', onClickHandler);\n\n    function onClickHandler() {\n        current_page++;\n        getPictures(current_query, limit, current_page).then(data => {\n\n            const firstGalleryItem = document.querySelector('li')\n            const { height } = firstGalleryItem.getBoundingClientRect();\n    \n            const images = data.hits;\n            const markup = images.map(image => createMarkup(image)).join('');\n\n            gallery.insertAdjacentHTML('beforeend', markup);\n\n            window.scrollBy({\n            top: height * 2, \n            behavior: 'smooth',\n            });\n\n            const totalHits = data.totalHits;\n            const totalPages = Math.floor(totalHits / limit);\n\n            if (current_page > totalPages) {\n                iziToast.error({ message: \"We're sorry, but you've reached the end of search results.\" });\n                loadBtn.classList.add('visually-hidden')\n            }\n            lightbox.refresh();\n        }).catch(() => {\n            iziToast.error({ message: \"Error occurred while fetching images. Please try again later!\" });\n        })\n    }\n     form.reset();\n    \n}\n\n"],"names":["getPictures","picture","limit","page","url","axios","error","createMarkup","webformatURL","largeImageURL","likes","views","comments","downloads","tags","form","loader","gallery","loadBtn","lightbox","SimpleLightbox","current_query","current_page","onFormHandler","event","query","iziToast","data","markup","image","onClickHandler","firstGalleryItem","height","totalHits","totalPages"],"mappings":"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"}